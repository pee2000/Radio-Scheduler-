<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MP3 Player with Scheduler & Icecast</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #4facfe, #00f2fe); /* Blue Gradient */
      color: white;
      text-align: center;
      margin: 0;
      padding: 0;
    }

    h1, h2, h3 {
      margin: 20px 0;
    }

    input, select {
      padding: 10px;
      margin: 10px;
      width: 300px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    button {
      padding: 10px 15px;
      background-color: white;
      color: #007bff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      margin: 5px;
    }

    button:hover {
      background-color: #e0e0e0;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    li {
      margin: 10px 0;
    }

    audio {
      margin-top: 20px;
      width: 100%;
      max-width: 400px;
    }

    .section {
      margin: 20px 0;
    }

    .playlist-button {
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <h1>MP3 Player with Scheduler & Icecast</h1>

  <!-- Icecast Settings Section -->
  <div class="section">
    <h2>Icecast Stream Settings</h2>
    <input type="text" id="streamUrl" placeholder="Stream URL">
    <input type="text" id="mountPoint" placeholder="Mount Point">
    <input type="password" id="streamPassword" placeholder="Password">
    <button id="connectStream">Connect</button>
    <h3 id="streamStatus">Not Connected</h3>
  </div>

  <!-- Add Song Section -->
  <div class="section">
    <h2>Add a Song to Playlist</h2>
    <input type="text" id="songLinkInput" placeholder="Enter MP3 URL">
    <button id="addLinkButton">Add to Playlist</button>
  </div>

  <!-- Playlist Section -->
  <div class="section">
    <h2>Playlist</h2>
    <ul id="playlist"></ul>
    <h3 id="nowPlaying">Now Playing: None</h3>
    <audio id="audioPlayer" controls></audio>
  </div>

  <!-- Scheduler Section -->
  <div class="section">
    <h2>Schedule a Song</h2>
    <select id="songSelector">
      <option value="">Select a Song</option>
    </select>
    <select id="daySelector">
      <option value="">Select Day</option>
      <option value="Sunday">Sunday</option>
      <option value="Monday">Monday</option>
      <option value="Tuesday">Tuesday</option>
      <option value="Wednesday">Wednesday</option>
      <option value="Thursday">Thursday</option>
      <option value="Friday">Friday</option>
      <option value="Saturday">Saturday</option>
    </select>
    <input type="time" id="timeSelector">
    <button id="scheduleButton">Schedule Song</button>
  </div>

  <script>
    // Icecast Settings
    const streamUrl = document.getElementById('streamUrl');
    const mountPoint = document.getElementById('mountPoint');
    const streamPassword = document.getElementById('streamPassword');
    const connectStream = document.getElementById('connectStream');
    const streamStatus = document.getElementById('streamStatus');

    connectStream.addEventListener('click', () => {
      if (streamUrl.value && mountPoint.value && streamPassword.value) {
        streamStatus.textContent = 'Connected to Icecast Stream!';
        streamStatus.style.color = 'lightgreen';
      } else {
        streamStatus.textContent = 'Please fill all Icecast settings!';
        streamStatus.style.color = 'red';
      }
    });

    // Playlist and Scheduler
    let playlistItems = JSON.parse(localStorage.getItem('playlistItems')) || [];
    let scheduleItems = JSON.parse(localStorage.getItem('scheduleItems')) || [];

    const songLinkInput = document.getElementById('songLinkInput');
    const addLinkButton = document.getElementById('addLinkButton');
    const songSelector = document.getElementById('songSelector');
    const daySelector = document.getElementById('daySelector');
    const timeSelector = document.getElementById('timeSelector');
    const playlist = document.getElementById('playlist');
    const audioPlayer = document.getElementById('audioPlayer');
    const nowPlaying = document.getElementById('nowPlaying');
    const scheduleButton = document.getElementById('scheduleButton');

    function savePlaylist() {
      localStorage.setItem('playlistItems', JSON.stringify(playlistItems));
    }

    function saveSchedule() {
      localStorage.setItem('scheduleItems', JSON.stringify(scheduleItems));
    }

    function renderPlaylist() {
      playlist.innerHTML = '';
      songSelector.innerHTML = '<option value="">Select a Song</option>';

      playlistItems.forEach((item, index) => {
        const listItem = document.createElement('li');
        listItem.textContent = `Song ${index + 1}: ${item.link}`;

        const playButton = document.createElement('button');
        playButton.textContent = 'Play';
        playButton.classList.add('playlist-button');
        playButton.addEventListener('click', () => {
          audioPlayer.src = item.link;
          audioPlayer.play();
          nowPlaying.textContent = `Now Playing: ${item.link}`;
        });

        const deleteButton = document.createElement('button');
        deleteButton.textContent = 'Delete';
        deleteButton.classList.add('playlist-button');
        deleteButton.addEventListener('click', () => {
          playlistItems.splice(index, 1);
          savePlaylist();
          renderPlaylist();
        });

        listItem.appendChild(playButton);
        listItem.appendChild(deleteButton);
        playlist.appendChild(listItem);

        // Add to song selector for scheduling
        const option = document.createElement('option');
        option.value = item.link;
        option.textContent = `Song ${index + 1}`;
        songSelector.appendChild(option);
      });
    }

    addLinkButton.addEventListener('click', () => {
      const link = songLinkInput.value.trim();

      if (!link) {
        alert('Please provide a song link!');
        return;
      }

      playlistItems.push({ link });
      savePlaylist();
      renderPlaylist();

      songLinkInput.value = '';
    });

    scheduleButton.addEventListener('click', () => {
      const selectedSong = songSelector.value;
      const selectedDay = daySelector.value;
      const selectedTime = timeSelector.value;

      if (!selectedSong || !selectedDay || !selectedTime) {
        alert('Please select a song, day, and time!');
        return;
      }

      scheduleItems.push({ link: selectedSong, day: selectedDay, time: selectedTime });
      saveSchedule();
      alert(`Scheduled song for ${selectedDay} at ${selectedTime}`);
    });

    function checkScheduler() {
      const now = new Date();
      const currentDay = now.toLocaleDateString('en-US', { weekday: 'long' });
      const currentTime = now.toTimeString().slice(0, 5);

      scheduleItems.forEach(item => {
        if (item.day === currentDay && item.time === currentTime) {
          audioPlayer.src = item.link;
          audioPlayer.play();
          nowPlaying.textContent = `Now Playing: ${item.link}`;
        }
      });
    }

    setInterval(checkScheduler, 60000); // Check every minute
    renderPlaylist();
  </script>
</body>
</html>
